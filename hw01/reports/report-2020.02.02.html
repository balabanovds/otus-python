<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>rbui log analysis report</title>
  <meta name="description" content="rbui log analysis report">
  <style type="text/css">
    html, body {
      background-color: black;
    }
    th {
      text-align: center;
      color: silver;
      font-style: bold;
      padding: 5px;
      cursor: pointer;
    }
    table {
      width: auto;
      border-collapse: collapse;
      margin: 1%;
      color: silver;
    }
    td {
      text-align: right;
      font-size: 1.1em;
      padding: 5px;
    }
    .report-table-body-cell-url {
      text-align: left;
      width: 20%;
    }
    .clipped {
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow:hidden !important;
      max-width: 700px;
      word-wrap: break-word;
      display:inline-block;
    }
    .url {
      cursor: pointer;
      color: #729FCF;
    }
    .alert {
      color: red;
    }
  </style>
</head>

<body>
  <table border="1" class="report-table">
  <thead>
    <tr class="report-table-header-row">
    </tr>
  </thead>
  <tbody class="report-table-body">
  </tbody>

  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.3/js/jquery.tablesorter.min.js" integrity="sha512-qzgd5cYSZcosqpzpn7zF2ZId8f/8CHmFKZ8j7mU4OUXTNRd5g+ZHBPsgKEwoqxCtdQvExE5LprwwPAgoicguNg==" crossorigin="anonymous"></script>
  <script type="text/javascript">
  !function($) {
    var table = [{'count': 1, 'durations': [0.39], 'count_perc': 2.0, 'time_sum': 0.39, 'time_perc': 1.159058487874465, 'time_avg': 0.39, 'time_max': 0.39, 'time_med': 0.39, 'url': '/api/v2/banner/25019354'}, {'count': 1, 'durations': [0.133], 'count_perc': 2.0, 'time_sum': 0.133, 'time_perc': 0.3952686638135996, 'time_avg': 0.133, 'time_max': 0.133, 'time_med': 0.133, 'url': '/api/1/photogenic_banners/list/?server_name=WIN7RB4'}, {'count': 1, 'durations': [0.199], 'count_perc': 2.0, 'time_sum': 0.199, 'time_perc': 0.5914170233000475, 'time_avg': 0.199, 'time_max': 0.199, 'time_med': 0.199, 'url': '/api/v2/banner/16852664'}, {'count': 1, 'durations': [0.704], 'count_perc': 2.0, 'time_sum': 0.704, 'time_perc': 2.0922491678554445, 'time_avg': 0.704, 'time_max': 0.704, 'time_med': 0.704, 'url': '/api/v2/slot/4705/groups'}, {'count': 1, 'durations': [0.146], 'count_perc': 2.0, 'time_sum': 0.146, 'time_perc': 0.4339039467427484, 'time_avg': 0.146, 'time_max': 0.146, 'time_med': 0.146, 'url': '/api/v2/internal/banner/24294027/info'}, {'count': 1, 'durations': [0.628], 'count_perc': 2.0, 'time_sum': 0.628, 'time_perc': 1.8663813599619588, 'time_avg': 0.628, 'time_max': 0.628, 'time_med': 0.628, 'url': '/api/v2/group/1769230/banners'}, {'count': 1, 'durations': [0.067], 'count_perc': 2.0, 'time_sum': 0.067, 'time_perc': 0.1991203043271517, 'time_avg': 0.067, 'time_max': 0.067, 'time_med': 0.067, 'url': '/api/v2/group/7786679/statistic/sites/?date_type=day&date_from=2017-06-28&date_to=2017-06-28'}, {'count': 1, 'durations': [0.138], 'count_perc': 2.0, 'time_sum': 0.138, 'time_perc': 0.41012838801711843, 'time_avg': 0.138, 'time_max': 0.138, 'time_med': 0.138, 'url': '/api/v2/banner/1717161'}, {'count': 2, 'durations': [0.003, 0.002], 'count_perc': 4.0, 'time_sum': 0.005, 'time_perc': 0.014859724203518781, 'time_avg': 0.0025, 'time_max': 0.003, 'time_med': 0.0025, 'url': '/export/appinstall_raw/2017-06-29/'}, {'count': 1, 'durations': [0.157], 'count_perc': 2.0, 'time_sum': 0.157, 'time_perc': 0.4665953399904897, 'time_avg': 0.157, 'time_max': 0.157, 'time_med': 0.157, 'url': '/api/v2/slot/4822/groups'}, {'count': 1, 'durations': [0.726], 'count_perc': 2.0, 'time_sum': 0.726, 'time_perc': 2.157631954350927, 'time_avg': 0.726, 'time_max': 0.726, 'time_med': 0.726, 'url': '/api/v2/banner/24987703'}, {'count': 2, 'durations': [0.001, 0.001], 'count_perc': 4.0, 'time_sum': 0.002, 'time_perc': 0.005943889681407513, 'time_avg': 0.001, 'time_max': 0.001, 'time_med': 0.001, 'url': '/export/appinstall_raw/2017-06-30/'}, {'count': 1, 'durations': [0.738], 'count_perc': 2.0, 'time_sum': 0.738, 'time_perc': 2.193295292439372, 'time_avg': 0.738, 'time_max': 0.738, 'time_med': 0.738, 'url': '/api/v2/banner/25020545'}, {'count': 1, 'durations': [0.181], 'count_perc': 2.0, 'time_sum': 0.181, 'time_perc': 0.5379220161673799, 'time_avg': 0.181, 'time_max': 0.181, 'time_med': 0.181, 'url': '/api/v2/banner/7763463'}, {'count': 1, 'durations': [0.19], 'count_perc': 2.0, 'time_sum': 0.19, 'time_perc': 0.5646695197337137, 'time_avg': 0.19, 'time_max': 0.19, 'time_med': 0.19, 'url': '/api/v2/banner/16168711'}, {'count': 1, 'durations': [0.841], 'count_perc': 2.0, 'time_sum': 0.841, 'time_perc': 2.4994056110318588, 'time_avg': 0.841, 'time_max': 0.841, 'time_med': 0.841, 'url': '/api/v2/banner/25023278'}, {'count': 1, 'durations': [0.068], 'count_perc': 2.0, 'time_sum': 0.068, 'time_perc': 0.20209224916785543, 'time_avg': 0.068, 'time_max': 0.068, 'time_med': 0.068, 'url': '/api/v2/group/7786682/statistic/sites/?date_type=day&date_from=2017-06-28&date_to=2017-06-28'}, {'count': 1, 'durations': [0.917], 'count_perc': 2.0, 'time_sum': 0.917, 'time_perc': 2.7252734189253447, 'time_avg': 0.917, 'time_max': 0.917, 'time_med': 0.917, 'url': '/api/v2/banner/25013431'}, {'count': 1, 'durations': [0.072], 'count_perc': 2.0, 'time_sum': 0.072, 'time_perc': 0.21398002853067044, 'time_avg': 0.072, 'time_max': 0.072, 'time_med': 0.072, 'url': '/api/v2/internal/banner/24288647/info'}, {'count': 1, 'durations': [0.158], 'count_perc': 2.0, 'time_sum': 0.158, 'time_perc': 0.46956728483119353, 'time_avg': 0.158, 'time_max': 0.158, 'time_med': 0.158, 'url': '/api/v2/banner/21456892'}, {'count': 1, 'durations': [0.058], 'count_perc': 2.0, 'time_sum': 0.058, 'time_perc': 0.17237280076081787, 'time_avg': 0.058, 'time_max': 0.058, 'time_med': 0.058, 'url': '/api/v2/internal/banner/24197629/info'}, {'count': 1, 'durations': [0.061], 'count_perc': 2.0, 'time_sum': 0.061, 'time_perc': 0.18128863528292913, 'time_avg': 0.061, 'time_max': 0.061, 'time_med': 0.061, 'url': '/api/v2/group/7786683/statistic/sites/?date_type=day&date_from=2017-06-28&date_to=2017-06-28'}, {'count': 1, 'durations': [0.156], 'count_perc': 2.0, 'time_sum': 0.156, 'time_perc': 0.46362339514978596, 'time_avg': 0.156, 'time_max': 0.156, 'time_med': 0.156, 'url': '/api/v2/banner/16803530'}, {'count': 1, 'durations': [1.243], 'count_perc': 2.0, 'time_sum': 1.243, 'time_perc': 3.694127436994769, 'time_avg': 1.243, 'time_max': 1.243, 'time_med': 1.243, 'url': '/api/v2/banner/24913311'}, {'count': 1, 'durations': [1.321], 'count_perc': 2.0, 'time_sum': 1.321, 'time_perc': 3.925939134569662, 'time_avg': 1.321, 'time_max': 1.321, 'time_med': 1.321, 'url': '/api/v2/banner/25019908'}, {'count': 1, 'durations': [1.403], 'count_perc': 2.0, 'time_sum': 1.403, 'time_perc': 4.16963861150737, 'time_avg': 1.403, 'time_max': 1.403, 'time_med': 1.403, 'url': '/api/v2/banner/24998073'}, {'count': 1, 'durations': [0.056], 'count_perc': 2.0, 'time_sum': 0.056, 'time_perc': 0.16642891107941035, 'time_avg': 0.056, 'time_max': 0.056, 'time_med': 0.056, 'url': '/api/v2/group/7786984/statistic/sites/?date_type=day&date_from=2017-06-28&date_to=2017-06-28'}, {'count': 1, 'durations': [0.68], 'count_perc': 2.0, 'time_sum': 0.68, 'time_perc': 2.0209224916785544, 'time_avg': 0.68, 'time_max': 0.68, 'time_med': 0.68, 'url': '/api/v2/group/1823183/banners'}, {'count': 1, 'durations': [1.49], 'count_perc': 2.0, 'time_sum': 1.49, 'time_perc': 4.428197812648596, 'time_avg': 1.49, 'time_max': 1.49, 'time_med': 1.49, 'url': '/api/v2/banner/25047606'}, {'count': 1, 'durations': [0.003], 'count_perc': 2.0, 'time_sum': 0.003, 'time_perc': 0.008915834522111268, 'time_avg': 0.003, 'time_max': 0.003, 'time_med': 0.003, 'url': '/api/v2/test/auth/'}, {'count': 1, 'durations': [0.035], 'count_perc': 2.0, 'time_sum': 0.035, 'time_perc': 0.10401806942463149, 'time_avg': 0.035, 'time_max': 0.035, 'time_med': 0.035, 'url': '/accounts/login/'}, {'count': 1, 'durations': [0.003], 'count_perc': 2.0, 'time_sum': 0.003, 'time_perc': 0.008915834522111268, 'time_avg': 0.003, 'time_max': 0.003, 'time_med': 0.003, 'url': '/api/v2/target/12988/list?status=1'}, {'count': 1, 'durations': [0.145], 'count_perc': 2.0, 'time_sum': 0.145, 'time_perc': 0.4309320019020446, 'time_avg': 0.145, 'time_max': 0.145, 'time_med': 0.145, 'url': '/api/v2/banner/7957213'}, {'count': 1, 'durations': [1.665], 'count_perc': 2.0, 'time_sum': 1.665, 'time_perc': 4.948288159771754, 'time_avg': 1.665, 'time_max': 1.665, 'time_med': 1.665, 'url': '/api/v2/banner/25032604'}, {'count': 1, 'durations': [2.577], 'count_perc': 2.0, 'time_sum': 2.577, 'time_perc': 7.65870185449358, 'time_avg': 2.577, 'time_max': 2.577, 'time_med': 2.577, 'url': '/api/1/banners/?campaign=7789704'}, {'count': 1, 'durations': [1.68], 'count_perc': 2.0, 'time_sum': 1.68, 'time_perc': 4.99286733238231, 'time_avg': 1.68, 'time_max': 1.68, 'time_med': 1.68, 'url': '/api/v2/banner/25040266'}, {'count': 1, 'durations': [0.063], 'count_perc': 2.0, 'time_sum': 0.063, 'time_perc': 0.18723252496433665, 'time_avg': 0.063, 'time_max': 0.063, 'time_med': 0.063, 'url': '/api/v2/internal/banner/24273184/info'}, {'count': 1, 'durations': [0.063], 'count_perc': 2.0, 'time_sum': 0.063, 'time_perc': 0.18723252496433665, 'time_avg': 0.063, 'time_max': 0.063, 'time_med': 0.063, 'url': '/api/v2/group/7808057/statistic/sites/?date_type=day&date_from=2017-06-28&date_to=2017-06-28'}, {'count': 1, 'durations': [6.828], 'count_perc': 2.0, 'time_sum': 6.828, 'time_perc': 20.292439372325248, 'time_avg': 6.828, 'time_max': 6.828, 'time_med': 6.828, 'url': '/agency/banners_stats/?date1=26-06-2017&date2=28-06-2017&date_type=day&do=1&rt=campaign&oi=5370438&as_json=1'}, {'count': 1, 'durations': [0.314], 'count_perc': 2.0, 'time_sum': 0.314, 'time_perc': 0.9331906799809794, 'time_avg': 0.314, 'time_max': 0.314, 'time_med': 0.314, 'url': '/api/1/banners/?campaign=1236490'}, {'count': 1, 'durations': [0.146], 'count_perc': 2.0, 'time_sum': 0.146, 'time_perc': 0.4339039467427484, 'time_avg': 0.146, 'time_max': 0.146, 'time_med': 0.146, 'url': '/api/1/campaigns/?id=7789709'}, {'count': 1, 'durations': [1.973], 'count_perc': 2.0, 'time_sum': 1.973, 'time_perc': 5.863647170708512, 'time_avg': 1.973, 'time_max': 1.973, 'time_med': 1.973, 'url': '/api/v2/banner/25006136'}, {'count': 1, 'durations': [0.148], 'count_perc': 2.0, 'time_sum': 0.148, 'time_perc': 0.43984783642415587, 'time_avg': 0.148, 'time_max': 0.148, 'time_med': 0.148, 'url': '/api/1/banners/?campaign=7789709'}, {'count': 1, 'durations': [0.064], 'count_perc': 2.0, 'time_sum': 0.064, 'time_perc': 0.1902044698050404, 'time_avg': 0.064, 'time_max': 0.064, 'time_med': 0.064, 'url': '/api/v2/group/7820980/statistic/sites/?date_type=day&date_from=2017-06-28&date_to=2017-06-28'}, {'count': 1, 'durations': [2.115], 'count_perc': 2.0, 'time_sum': 2.115, 'time_perc': 6.285663338088446, 'time_avg': 2.115, 'time_max': 2.115, 'time_med': 2.115, 'url': '/api/v2/banner/24915508'}, {'count': 1, 'durations': [0.163], 'count_perc': 2.0, 'time_sum': 0.163, 'time_perc': 0.48442700903471225, 'time_avg': 0.163, 'time_max': 0.163, 'time_med': 0.163, 'url': '/api/1/campaigns/?id=7789711'}, {'count': 1, 'durations': [2.196], 'count_perc': 2.0, 'time_sum': 2.196, 'time_perc': 6.526390870185448, 'time_avg': 2.196, 'time_max': 2.196, 'time_med': 2.196, 'url': '/api/v2/banner/25047605'}, {'count': 1, 'durations': [0.539], 'count_perc': 2.0, 'time_sum': 0.539, 'time_perc': 1.6018782691393247, 'time_avg': 0.539, 'time_max': 0.539, 'time_med': 0.539, 'url': '/api/v2/group/2921166/banners'}];
    var reportDates;
    var columns = new Array();
    var lastRow = 150;
    var $table = $(".report-table-body");
    var $header = $(".report-table-header-row");
    var $selector = $(".report-date-selector");

    $(document).ready(function() {
      $(window).bind("scroll", bindScroll);
        var row = table[0];
        for (k in row) {
          columns.push(k);
        }
        columns = columns.sort();
        columns = columns.slice(columns.length -1, columns.length).concat(columns.slice(0, columns.length -1));
        drawColumns();
        drawRows(table.slice(0, lastRow));
        $(".report-table").tablesorter(); 
    });

    function drawColumns() {
      for (var i = 0; i < columns.length; i++) {
        var $th = $("<th></th>").text(columns[i])
                                .addClass("report-table-header-cell")
        $header.append($th);
      }
    }

    function drawRows(rows) {
      for (var i = 0; i < rows.length; i++) {
        var row = rows[i];
        var $row = $("<tr></tr>").addClass("report-table-body-row");
        for (var j = 0; j < columns.length; j++) {
          var columnName = columns[j];
          var $cell = $("<td></td>").addClass("report-table-body-cell");
          if (columnName == "url") {
            var url = "https://rb.mail.ru" + row[columnName];
            var $link = $("<a></a>").attr("href", url)
                                    .attr("title", url)
                                    .attr("target", "_blank")
                                    .addClass("clipped")
                                    .addClass("url")
                                    .text(row[columnName]);
            $cell.addClass("report-table-body-cell-url");
            $cell.append($link);
          }
          else {
            $cell.text(row[columnName]);
            if (columnName == "time_avg" && row[columnName] > 0.9) {
              $cell.addClass("alert");
            }
          }
          $row.append($cell);
        }
        $table.append($row);
      }
      $(".report-table").trigger("update"); 
    }

    function bindScroll() {
      if($(window).scrollTop() == $(document).height() - $(window).height()) {
        if (lastRow < 1000) {
          drawRows(table.slice(lastRow, lastRow + 50));
          lastRow += 50;
        }
      }
    }

  }(window.jQuery)
  </script>
</body>
</html>
